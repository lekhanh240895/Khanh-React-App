{"ast":null,"code":"var _jsxFileName = \"D:\\\\Rim\\\\react-app\\\\src\\\\components\\\\Profile\\\\index.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useMemo, useEffect } from \"react\";\nimport { Button, Alert, Card } from \"react-bootstrap\";\nimport { auth } from \"../../firebase/config\";\nimport { useAuth } from \"../../contexts/AuthContext\";\nimport { useHistory, Link } from \"react-router-dom\";\nimport { useAppContext } from \"../../contexts/AppContext\";\nimport useFirestore from \"../hooks/useFirestore\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const Profile = () => {\n  _s();\n\n  var _user$displayName;\n\n  const {\n    logout,\n    user\n  } = useAuth();\n  const [error, setError] = useState(\"\");\n  const history = useHistory();\n  const {\n    users,\n    addDocument,\n    updateDocument\n  } = useAppContext();\n  const condition = useMemo(() => {\n    return {\n      fieldName: \"email\",\n      operator: \"==\",\n      compareValue: user.email\n    };\n  }, [user.email]);\n  const userDoc = useFirestore(\"users\", condition);\n  console.log(userDoc);\n  useEffect(() => {\n    //function IsDiffer = (element, index, array) => {\n    //   return element.email !== user.email\n    // }\n    // if (users.every(isDiffer)) {}\n    if (users.every(dbUser => dbUser.email !== user.email)) {\n      return addDocument(\"users\", {\n        displayName: user.displayName,\n        email: user.email,\n        photoURL: user.photoURL,\n        uid: user.email,\n        providerID: user.providerData[0].providerId\n      });\n    }\n\n    updateDocument(\"users\", userDoc[0].id, {\n      displayName: user.displayName,\n      email: user.email,\n      photoURL: user.photoURL,\n      uid: user.email\n    }); // const updateData = async () => {\n    //   const q = query(\n    //     collection(db, \"users\"),\n    //     where(\"email\", \"==\", user.email)\n    //   );\n    //   const querySnapshot = await getDocs(q);\n    //   querySnapshot.forEach((docSnap) => {\n    //     updateDoc(doc(db, \"users\", docSnap.id), {\n    //       displayName: user.displayName,\n    //       email: user.email,\n    //       photoURL: user.photoURL,\n    //       uid: user.email,\n    //       lastModified: serverTimestamp(),\n    //     });\n    //     console.log(\"update data ok\");\n    //   });\n    // };\n    // updateData();\n\n    console.log(users);\n    console.log(\"User:\", user); //eslint-disable-next-line\n  }, [user]);\n\n  const handleLogOut = async () => {\n    setError(\"\");\n\n    try {\n      await logout(auth);\n      history.push(\"/login\");\n    } catch (error) {\n      setError(error.message);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(Card, {\n    className: \"d-flex flex-row justify-content-center align-items-center\",\n    children: /*#__PURE__*/_jsxDEV(Card.Body, {\n      style: {\n        maxWidth: \"400px\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(Card.Header, {\n        as: \"h1\",\n        className: \"mb-4\",\n        children: \"Profile\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 9\n      }, this), error && /*#__PURE__*/_jsxDEV(Alert, {\n        variant: \"danger\",\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 19\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-3 text-center d-flex justify-content-center\",\n        children: user.photoURL ? /*#__PURE__*/_jsxDEV(Card.Img, {\n          variant: \"top\",\n          src: user.photoURL,\n          alt: \"Avatar\",\n          style: {\n            width: \"100px\",\n            height: \"100px\",\n            borderRadius: \"50%\"\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            width: \"100px\",\n            height: \"100px\",\n            border: \"1px solid #0B3D6B\",\n            borderRadius: \"50%\",\n            background: \"#0B3D6B\"\n          },\n          className: \"text-white d-flex justify-content-center align-items-center\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              fontSize: \"30px\",\n              fontWeight: \"600\"\n            },\n            children: (_user$displayName = user.displayName) === null || _user$displayName === void 0 ? void 0 : _user$displayName.charAt(0)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 115,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Card.Text, {\n        className: \"text-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Email:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 11\n        }, this), \" \", user.email]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Card.Text, {\n        className: \"text-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Name:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 11\n        }, this), \" \", user.displayName]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center mb-3\",\n        children: /*#__PURE__*/_jsxDEV(Link, {\n          to: \"/update-profile\",\n          className: \"text-white list-style-none\",\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            children: \"Update Profile\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 132,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center w-100 mb-3\",\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          onClick: handleLogOut,\n          children: \"Log Out\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 84,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Profile, \"i+iRmaGWinvfj8h91eRGuAP2nvc=\", false, function () {\n  return [useAuth, useHistory, useAppContext, useFirestore];\n});\n\n_c = Profile;\nexport default Profile;\n\nvar _c;\n\n$RefreshReg$(_c, \"Profile\");","map":{"version":3,"sources":["D:/Rim/react-app/src/components/Profile/index.js"],"names":["React","useState","useMemo","useEffect","Button","Alert","Card","auth","useAuth","useHistory","Link","useAppContext","useFirestore","Profile","logout","user","error","setError","history","users","addDocument","updateDocument","condition","fieldName","operator","compareValue","email","userDoc","console","log","every","dbUser","displayName","photoURL","uid","providerID","providerData","providerId","id","handleLogOut","push","message","maxWidth","width","height","borderRadius","border","background","fontSize","fontWeight","charAt"],"mappings":"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","sourcesContent":["import React, { useState, useMemo, useEffect } from \"react\";\r\nimport { Button, Alert, Card } from \"react-bootstrap\";\r\nimport { auth } from \"../../firebase/config\";\r\nimport { useAuth } from \"../../contexts/AuthContext\";\r\nimport { useHistory, Link } from \"react-router-dom\";\r\nimport { useAppContext } from \"../../contexts/AppContext\";\r\nimport useFirestore from \"../hooks/useFirestore\";\r\n\r\nexport const Profile = () => {\r\n  const { logout, user } = useAuth();\r\n  const [error, setError] = useState(\"\");\r\n  const history = useHistory();\r\n  const { users, addDocument, updateDocument } = useAppContext();\r\n\r\n  const condition = useMemo(() => {\r\n    return {\r\n      fieldName: \"email\",\r\n      operator: \"==\",\r\n      compareValue: user.email,\r\n    };\r\n  }, [user.email]);\r\n\r\n  const userDoc = useFirestore(\"users\", condition);\r\n  console.log(userDoc)\r\n\r\n  useEffect(() => {\r\n    //function IsDiffer = (element, index, array) => {\r\n    //   return element.email !== user.email\r\n    // }\r\n    // if (users.every(isDiffer)) {}\r\n    if (users.every((dbUser) => dbUser.email !== user.email)) {\r\n      return addDocument(\"users\", {\r\n        displayName: user.displayName,\r\n        email: user.email,\r\n        photoURL: user.photoURL,\r\n        uid: user.email,\r\n        providerID: user.providerData[0].providerId,\r\n      });\r\n    }\r\n\r\n    updateDocument(\"users\", userDoc[0].id, {\r\n      displayName: user.displayName,\r\n      email: user.email,\r\n      photoURL: user.photoURL,\r\n      uid: user.email,\r\n    });\r\n\r\n    // const updateData = async () => {\r\n    //   const q = query(\r\n    //     collection(db, \"users\"),\r\n    //     where(\"email\", \"==\", user.email)\r\n    //   );\r\n    //   const querySnapshot = await getDocs(q);\r\n    //   querySnapshot.forEach((docSnap) => {\r\n    //     updateDoc(doc(db, \"users\", docSnap.id), {\r\n    //       displayName: user.displayName,\r\n    //       email: user.email,\r\n    //       photoURL: user.photoURL,\r\n    //       uid: user.email,\r\n    //       lastModified: serverTimestamp(),\r\n    //     });\r\n    //     console.log(\"update data ok\");\r\n    //   });\r\n    // };\r\n    // updateData();\r\n\r\n    console.log(users);\r\n    console.log(\"User:\", user);\r\n    //eslint-disable-next-line\r\n  }, [user]);\r\n\r\n  const handleLogOut = async () => {\r\n    setError(\"\");\r\n\r\n    try {\r\n      await logout(auth);\r\n      history.push(\"/login\");\r\n    } catch (error) {\r\n      setError(error.message);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Card className=\"d-flex flex-row justify-content-center align-items-center\">\r\n      <Card.Body style={{ maxWidth: \"400px\" }}>\r\n        <Card.Header as=\"h1\" className=\"mb-4\">\r\n          Profile\r\n        </Card.Header>\r\n\r\n        {error && <Alert variant=\"danger\">{error}</Alert>}\r\n\r\n        <div className=\"mb-3 text-center d-flex justify-content-center\">\r\n          {user.photoURL ? (\r\n            <Card.Img\r\n              variant=\"top\"\r\n              src={user.photoURL}\r\n              alt=\"Avatar\"\r\n              style={{\r\n                width: \"100px\",\r\n                height: \"100px\",\r\n                borderRadius: \"50%\",\r\n              }}\r\n            />\r\n          ) : (\r\n            <div\r\n              style={{\r\n                width: \"100px\",\r\n                height: \"100px\",\r\n                border: \"1px solid #0B3D6B\",\r\n                borderRadius: \"50%\",\r\n                background: \"#0B3D6B\",\r\n              }}\r\n              className=\"text-white d-flex justify-content-center align-items-center\"\r\n            >\r\n              <span style={{ fontSize: \"30px\", fontWeight: \"600\" }}>\r\n                {user.displayName?.charAt(0)}\r\n              </span>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        <Card.Text className=\"text-center\">\r\n          <strong>Email:</strong> {user.email}\r\n        </Card.Text>\r\n\r\n        <Card.Text className=\"text-center\">\r\n          <strong>Name:</strong> {user.displayName}\r\n        </Card.Text>\r\n\r\n        <div className=\"text-center mb-3\">\r\n          <Link to=\"/update-profile\" className=\"text-white list-style-none\">\r\n            <Button>Update Profile</Button>\r\n          </Link>\r\n        </div>\r\n\r\n        <div className=\"text-center w-100 mb-3\">\r\n          <Button onClick={handleLogOut}>Log Out</Button>\r\n        </div>\r\n      </Card.Body>\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default Profile;\r\n"]},"metadata":{},"sourceType":"module"}